<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>音乐播放器</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
    <style>
        /* 关键渲染路径优化 */
        .music-player-critical {
            opacity: 0;
            animation: fadeIn 0.3s ease forwards;
        }
        
        @keyframes fadeIn {
            to { opacity: 1; }
        }
    </style>
</head>
<body>
    <!-- 动态背景 -->
    <div class="dynamic-background"></div>
    
    <!-- 音乐播放器主容器 -->
    <div class="music-container music-player-critical">
        <!-- 音乐播放器 -->
        <div class="music-player">
            <!-- 专辑封面和歌曲信息 -->
            <div class="album-section">
                <div class="album-cover" id="album-cover">
                    <i class="fas fa-compact-disc"></i>
                </div>
                <div class="track-info">
                    <div class="track-title" id="track-title">歌曲标题</div>
                    <div class="track-artist" id="track-artist">歌手</div>
                    <div class="track-album" id="track-album">专辑</div>
                </div>
            </div>
            
            <!-- 进度条 -->
            <div class="progress-section">
                <div class="progress-bar" id="progress-bar">
                    <div class="progress" id="progress"></div>
                </div>
                <div class="time-display-section">
                    <span id="current-time">0:00</span>
                    <span id="duration">0:00</span>
                </div>
            </div>
            
            <!-- 控制按钮 -->
            <div class="controls">
                <button class="control-btn" id="prev-btn" aria-label="上一首">
                    <i class="fas fa-step-backward"></i>
                </button>
                <button class="control-btn play-pause" id="play-pause-btn" aria-label="播放">
                    <i class="fas fa-play"></i>
                </button>
                <button class="control-btn" id="next-btn" aria-label="下一首">
                    <i class="fas fa-step-forward"></i>
                </button>
            </div>
            
            <!-- 音量控制 -->
            <div class="volume-section">
                <i class="fas fa-volume-down"></i>
                <div class="volume-slider" id="volume-slider">
                    <div class="volume-progress" id="volume-progress"></div>
                </div>
                <i class="fas fa-volume-up"></i>
            </div>
        </div>
        
        <!-- 歌曲列表 -->
        <div class="song-list-container">
            <div class="song-list-title">
                <span>歌曲列表</span>
                <span class="song-count" id="file-count">0 首歌曲</span>
            </div>
            <div class="song-list" id="song-list">
                <!-- 歌曲列表将通过JavaScript动态生成 -->
            </div>
        </div>
    </div>
    
    <!-- 音频元素（隐藏） -->
    <audio id="audio-player" preload="none"></audio>
    
    <!-- 核心JS文件 -->
    <script src="music-player.js"></script>
    
    <script>
        // 页面加载优化
        document.addEventListener('DOMContentLoaded', function() {
            // 立即显示内容
            document.querySelector('.music-player-critical').style.opacity = '1';
            
            // 延迟初始化音乐播放器，让页面先渲染
            setTimeout(() => {
                if (window.MusicPlayer && typeof window.MusicPlayer.initializeMusicPlayer === 'function') {
                    window.MusicPlayer.initializeMusicPlayer().catch(console.error);
                } else if (typeof initializeMusicPlayer === 'function') {
                    initializeMusicPlayer().catch(console.error);
                } else {
                    console.error('音乐播放器初始化函数未找到');
                }
            }, 100);
            
            // 触摸设备优化
            if ('ontouchstart' in window) {
                // 增加触摸目标大小
                const buttons = document.querySelectorAll('.control-btn, .project-btn, .song-item');
                buttons.forEach(btn => {
                    btn.style.minHeight = '44px';
                    btn.style.minWidth = '44px';
                });
            }
        });
        
        // 离线支持
        window.addEventListener('online', function() {
            console.log('网络连接恢复');
            // 可以在这里重新加载数据
        });
        
        window.addEventListener('offline', function() {
            console.log('网络连接断开，使用缓存数据');
        });
    </script>
</body>
</html>