三色球物理模拟游戏规则详细梳理

一、基础设置

1. 界面：全黑背景，白色圆形边界
2. 球体：红、绿、蓝三个小球
3. 球体属性：
   · 大小相同，半径为白色圆圈半径的1/8
   · 初始位置：在白色圆圈内部，位于半径为白色圆圈半径0.9的同心圆上（同心圆不显示）
   · 初始间距：三个球等距分布（120度间隔）
   · 随机偏移：每个球初始方向有±15度的随机偏移

二、运动规则

1. 初始速度：每个球以圆圈半径/秒的速度向中心移动
2. 边界碰撞：
   · 碰撞白色边界时完全弹性反弹（无能量损失）
   · 碰撞后：从碰撞点到球中心生成一条细线，颜色与球相同
   · 线是永久存在的
3. 球间碰撞：
   · 不同颜色的球相撞时反弹
   · 球间碰撞不产生线
   · 完全弹性碰撞

三、线与球的交互规则

1. 线的基本属性：
   · 一端固定在边界碰撞点
   · 另一端实时连接在与线颜色相同的球心
   · 线随球的移动而移动
   · 线有颜色属性
2. 颜色改变规则：
   · 红球：可以改变绿色和蓝色的线
   · 绿球：可以改变红色和蓝色的线
   · 蓝球：可以改变红色和绿色的线
   · 重要：任何球都不能改变与自己颜色相同的线
3. 碰撞效果：
   · 当球碰到可以改变的线时：
     · 线的颜色改为球的颜色
     · 线的另一端开始跟随这个球
     · 球的速度增加0.01%（万分之一）

四、重力与销毁系统

1. 重力触发条件：
   · 每个球实时统计与自己颜色相同的线的数量
   · 如果一个球没有任何与自己颜色相同的线
2. 重力效果：
   · 给该球施加向下的重力（1g）
   · 移除该球与边界的碰撞检测（可以飞出边界）
   · 仍然与其他球碰撞
3. 销毁机制：
   · 受重力的球飞出屏幕后被销毁
   · 销毁时播放电子音（破碎声）
   · 销毁后移除该球相关的线

五、宇宙重启系统

1. 触发条件：游戏只剩下一个球存活时
2. 重启过程：
   · 阶段1：3秒内逐渐黑屏
   · 阶段2：1秒内逐渐全白
   · 阶段3：1秒冷却后恢复正常界面
   · 随后游戏完全重启，三个球重新初始化

六、物理参数

1. 基础参数：
   · 平时无质量/无重力
   · 反弹无能量损失（完全弹性）
   · 无摩擦
2. 可控参数：
   · 速度因子：控制初始速度
   · 重力因子：控制重力大小
   · 碰撞加速因子：控制线碰撞加速程度
   · 初始角度偏移：控制初始方向随机性

七、用户界面要求

1. 主界面：
   · 全屏显示游戏画布
   · 右上角小齿轮按钮
   · 左上角状态显示
2. 设置面板：
   · 点击齿轮按钮弹出全屏设置页面
   · 黑底白字界面
   · 可调整所有可控参数
   · 应用设置后游戏重启
3. 状态显示：
   · 每个球的状态（活跃/受重力/已销毁）
   · 存活球数
   · 线条数量

八、技术要求

1. 性能：
   · 刷新率要保证良好的观感
   · 不要因为刷新率影响球的速度
   · 支持触控操作
2. 代码要求：
   · 所有可修改参数都要注释
   · 逻辑清晰，易于维护

九、关键规则总结

1. 颜色改变是核心机制：每个球只能改变两种颜色的线，不能改变同色线
2. 重力与线的关系：球的存活依赖于同色线的数量
3. 宇宙循环：游戏结束会以视觉特效重启
4. 完全弹性物理：所有碰撞无能量损失

十、当前需要解决的bug

根据之前的对话，需要确保：

1. 红球可以改变绿线和蓝线
2. 绿球可以改变红线和蓝线
3. 蓝球可以改变红线和绿线
4. 所有球都不能改变与自己颜色相同的线
5. 线正确地连接到球的中心并实时移动

这个规则集构成了一个复杂的、自洽的物理模拟系统，每个部分都有明确的因果关系和交互逻辑。